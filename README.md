# multRD - 十六进制补丁版本
Windows 10/11 远程桌面多用户登录破解工具（十六进制补丁版）

## 功能说明
本工具通过直接修改 termsrv.dll 文件的十六进制代码来实现 Windows 远程桌面多用户登录功能，不再依赖预先修改好的 dll 文件替换。

## 支持的Windows版本
- Windows 10/11 x64 22H2
- Windows 10 20H2/2004  
- Windows 10 1903/1909
- Windows 10 1803
- 更高版本（通用模式）

## 十六进制补丁对照表
| Windows 版本 | 原始十六进制代码 | 替换为代码 |
|-------------|-----------------|-----------|
| Windows 10/11 x64 22H2 | 39 81 3C 06 00 00 0F 84 D9 61 01 00 | B8 00 01 00 00 89 81 38 06 00 00 90 |
| Windows 10 20H2/2004 | 39 81 3C 06 00 00 0F 84 D9 51 01 00 | 同上 |
| Windows 10 1903/1909 | 39 81 3C 06 00 00 0F 84 5D 61 01 00 | 同上 |
| Windows 10 1803 | 8B 99 3C 06 00 00 8B B9 38 06 00 00 | 同上 |

## 使用方法

### 安装补丁
1. 以管理员权限运行 `install.bat`
2. 脚本会自动检测Windows版本并应用相应的十六进制补丁
3. 对于未知版本或高于22H2的版本，会使用通用模式搜索 "39 81 3C 06 00 00" 开头的24位字符并替换
4. 安装完成后建议重启计算机

### 卸载补丁
1. 以管理员权限运行 `uninstall.bat`
2. 脚本会恢复原始的 dll 文件
3. 卸载完成后建议重启计算机

## 工作原理
1. **备份原文件**: 自动备份 `C:\Windows\System32\termsrv.dll` 为 `termsrv.dll.bak`
2. **十六进制转换**: 使用 `certutil` 将 dll 文件转换为十六进制格式
3. **模式匹配**: 根据Windows版本查找对应的十六进制模式
4. **补丁应用**: 将找到的模式替换为新的十六进制代码
5. **文件重建**: 将修改后的十六进制转换回 dll 文件
6. **服务重启**: 重启 TermService 服务使更改生效

## 技术特点
- **无需预置文件**: 不再需要 termsrv 文件夹中的预修改 dll 文件
- **版本自适应**: 自动检测Windows版本并应用对应补丁
- **通用兼容**: 对于新版本使用通用模式搜索和替换
- **安全备份**: 自动备份原文件，支持多版本备份
- **错误恢复**: 补丁失败时自动恢复原文件

## 注意事项
⚠️ **重要提醒**：
- 必须以管理员权限运行脚本
- TermService 服务可能无法正常关闭，但不影响安装过程
- **强烈建议安装或卸载后重启计算机**
- 如果存在多个备份版本，卸载时请手动重命名所需的备份文件

## 测试方法
安装完成后，可以通过以下步骤测试是否成功：

1. 以管理员权限打开 cmd
2. 创建测试账户（如果没有）：
   ```cmd
   net user test password /add
   net localgroup "remote desktop users" test /add
   ```
3. 打开远程桌面连接：`mstsc`
4. 输入地址：`127.0.0.2`
5. 使用测试账户登录
6. 如果能成功登录，则证明补丁安装成功
7. 删除测试账号：`net user test /del`

## 文件说明
- `install.bat`: 十六进制补丁安装脚本
- `uninstall.bat`: 补丁卸载脚本
- `README.md`: 本说明文件

## 故障排除
如果补丁应用失败：
1. 检查是否以管理员权限运行
2. 确认Windows版本是否受支持
3. 检查 termsrv.dll 文件是否被其他程序占用
4. 查看脚本输出的错误信息
5. 如有必要，手动恢复备份文件
